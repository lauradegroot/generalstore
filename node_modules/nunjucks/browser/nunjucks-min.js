(function(){var e={};(function(){function t(e,n,r){var i=Object.create(e.prototype),s=/xyz/.test(function(){xyz})?/\bparent\b/:/.*/;r=r||{};for(var o in r){var u=r[o],a=i[o];typeof a=="function"&&typeof u=="function"&&s.test(u)?i[o]=function(e,t){return function(){var n=this.parent;this.parent=t;var r=e.apply(this,arguments);return this.parent=n,r}}(u,a):i[o]=u}i.typename=n;var f=function(){i.init&&i.init.apply(this,arguments)};return f.prototype=i,f.prototype.constructor=f,f.extend=function(e,n){return typeof e=="object"&&(n=e,e="anonymous"),t(f,e,n)},f}e.object=t(Object,"Object",{})})(),function(){var t=Array.prototype,n=Object.prototype,r={"&":"&amp;",'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;"},i=function(e){return r[e]},s=e.lib={};s.withPrettyErrors=function(e,t,n){try{return n()}catch(r){r.Update||(r=new s.TemplateError(r)),r.Update(e);if(!t){var i=r;r=new Error(i.message),r.name=i.name}throw r}},s.TemplateError=function(e,t,n){var r=this;return e instanceof Error?(r=e,e=e.name+": "+e.message):Error.captureStackTrace(r),r.name="Template render error",r.message=e,r.lineno=t,r.colno=n,r.firstUpdate=!0,r.Update=function(e){var t="("+(e||"unknown path")+")";return this.firstUpdate&&(this.lineno&&this.colno?t+=" [Line "+this.lineno+", Column "+this.colno+"]":this.lineno&&(t+=" [Line "+this.lineno+"]")),t+="\n ",this.firstUpdate&&(t+=" "),this.message=t+(this.message||""),this.firstUpdate=!1,this},r},s.TemplateError.prototype=Error.prototype,s.escape=function(e){return e.replace(/[&"'<>]/g,i)},s.isFunction=function(e){return n.toString.call(e)=="[object Function]"},s.isArray=Array.isArray||function(e){return n.toString.call(e)=="[object Array]"},s.isString=function(e){return n.toString.call(e)=="[object String]"},s.isObject=function(e){return e===Object(e)},s.groupBy=function(e,t){var n={},r=s.isFunction(t)?t:function(e){return e[t]};for(var i=0;i<e.length;i++){var o=e[i],u=r(o,i);(n[u]||(n[u]=[])).push(o)}return n},s.toArray=function(e){return Array.prototype.slice.call(e)},s.without=function(e){var t=[];if(!e)return t;var n=-1,r=e.length,i=s.toArray(arguments).slice(1);while(++n<r)i.indexOf(e[n])===-1&&t.push(e[n]);return t},s.extend=function(e,t){for(var n in t)e[n]=t[n];return e},s.repeat=function(e,t){var n="";for(var r=0;r<t;r++)n+=e;return n},s.each=function(e,n,r){if(e==null)return;if(t.each&&e.each==t.each)e.forEach(n,r);else if(e.length===+e.length)for(var i=0,s=e.length;i<s;i++)n.call(r,e[i],i,e)},s.map=function(e,n){var r=[];if(e==null)return r;if(t.map&&e.map===t.map)return e.map(n);for(var i=0;i<e.length;i++)r[r.length]=n(e[i],i);return e.length===+e.length&&(r.length=e.length),r}}(),function(){function i(e,t,n){return function(){var r=u(arguments),i,s=o(arguments);if(r>e.length){i=Array.prototype.slice.call(arguments,0,e.length);var a=Array.prototype.slice.call(arguments,i.length,r);for(var f=0;f<a.length;f++)f<t.length&&(s[t[f]]=a[f]);i.push(s)}else if(r<e.length){i=Array.prototype.slice.call(arguments,0,r);for(var f=r;f<e.length;f++){var l=e[f];i.push(s[l]),delete s[l]}i.push(s)}else i=arguments;return n.apply(this,i)}}function s(e){return e.__keywords=!0,e}function o(e){var t=e.length;if(t){var n=e[t-1];if(n&&n.hasOwnProperty("__keywords"))return n}return{}}function u(e){var t=e.length;if(t===0)return 0;var n=e[t-1];return n&&n.hasOwnProperty("__keywords")?t-1:t}function a(e){if(typeof e!="string")return e;this.toString=function(){return e},this.length=e.length;var t=["charAt","charCodeAt","concat","contains","endsWith","fromCharCode","indexOf","lastIndexOf","length","localeCompare","match","quote","replace","search","slice","split","startsWith","substr","substring","toLocaleLowerCase","toLocaleUpperCase","toLowerCase","toUpperCase","trim","trimLeft","trimRight"];for(var n=0;n<t.length;n++)this[t[n]]=l(e[t[n]])}function f(e,t){return e instanceof a?new a(t):t.toString()}function l(e){return function(){var t=e.apply(this,arguments);return typeof t=="string"?new a(t):t}}function c(e,n){return e=e!==undefined&&e!==null?e:"",n&&typeof e=="string"&&(e=t.escape(e)),e}function h(e,t){return e=e||{},typeof e[t]=="function"?function(){return e[t].apply(e,arguments)}:e[t]}function p(e,t,n){if(!e)throw new Error("Unable to call `"+t+"`, which is undefined or falsey");if(typeof e!="function")throw new Error("Unable to call `"+t+"`, which is not a function");return e.apply(this,n)}function d(e,t,n){var r=e.lookup(n);return r!==undefined&&r!==null?r:t.lookup(n)}function v(e,n,r){throw e.lineno?e:new t.TemplateError(e,n,r)}var t=e.lib,n=e.object,r=n.extend({init:function(e){this.variables={},this.parent=e},set:function(e,t){var n=e.split("."),r=this.variables;for(var i=0;i<n.length-1;i++){var s=n[i];r[s]||(r[s]={}),r=r[s]}r[n[n.length-1]]=t},lookup:function(e){var t=this.parent,n=this.variables[e];return n!==undefined&&n!==null?n:t&&t.lookup(e)},push:function(){return new r(this)},pop:function(){return this.parent}});e.runtime={Frame:r,makeMacro:i,makeKeywordArgs:s,numArgs:u,suppressValue:c,memberLookup:h,contextOrFrameLookup:d,callWrap:p,handleError:v,isArray:t.isArray,SafeString:a,copySafeness:f}}(),function(){var t=e.lib,n=e.runtime,r={abs:function(e){return Math.abs(e)},batch:function(e,t,n){var r=[],i=[];for(var s=0;s<e.length;s++)s%t===0&&i.length&&(r.push(i),i=[]),i.push(e[s]);if(i.length){if(n)for(var s=i.length;s<t;s++)i.push(n);r.push(i)}return r},capitalize:function(e){var t=e.toLowerCase();return n.copySafeness(e,t[0].toUpperCase()+t.slice(1))},center:function(e,r){r=r||80;if(e.length>=r)return e;var i=r-e.length,s=t.repeat(" ",i/2-i%2),o=t.repeat(" ",i/2);return n.copySafeness(e,s+e+o)},"default":function(e,t){return e?e:t},dictsort:function(e,n,r){if(!t.isObject(e))throw new t.TemplateError("dictsort filter: val must be an object");var i=[];for(var s in e)i.push([s,e[s]]);var o;if(r===undefined||r==="key")o=0;else{if(r!=="value")throw new t.TemplateError("dictsort filter: You can only sort by either key or value");o=1}return i.sort(function(e,r){var i=e[o],s=r[o];return n||(t.isString(i)&&(i=i.toUpperCase()),t.isString(s)&&(s=s.toUpperCase())),i>s?1:i==s?0:-1}),i},escape:function(e){return typeof e=="string"||e instanceof n.SafeString?t.escape(e):e},safe:function(e){return new n.SafeString(e)},first:function(e){return e[0]},groupby:function(e,n){return t.groupBy(e,n)},indent:function(e,r,i){r=r||4;var s="",o=e.split("\n"),u=t.repeat(" ",r);for(var a=0;a<o.length;a++)a==0&&!i?s+=o[a]+"\n":s+=u+o[a]+"\n";return n.copySafeness(e,s)},join:function(e,n,r){return n=n||"",r&&(e=t.map(e,function(e){return e[r]})),e.join(n)},last:function(e){return e[e.length-1]},length:function(e){return e.length},list:function(e){if(t.isString(e))return e.split("");if(t.isObject(e)){var n=[];if(Object.keys)n=Object.keys(e);else for(var r in e)n.push(r);return t.map(n,function(t){return{key:t,value:e[t]}})}throw new t.TemplateError("list filter: type not iterable")},lower:function(e){return e.toLowerCase()},random:function(e){var t=Math.floor(Math.random()*e.length);return t==e.length&&t--,e[t]},replace:function(e,t,r,i){var s=e,o=s,u=1;s=s.replace(t,r);while(o!=s){if(u>=i)break;o=s,s=s.replace(t,r),u++}return n.copySafeness(e,s)},reverse:function(e){var i;return t.isString(e)?i=r.list(e):i=t.map(e,function(e){return e}),i.reverse(),t.isString(e)?n.copySafeness(e,i.join("")):i},round:function(e,t,n){t=t||0;var r=Math.pow(10,t),i;return n=="ceil"?i=Math.ceil:n=="floor"?i=Math.floor:i=Math.round,i(e*r)/r},slice:function(e,t,n){var r=Math.floor(e.length/t),i=e.length%t,s=0,o=[];for(var u=0;u<t;u++){var a=s+u*r;u<i&&s++;var f=s+(u+1)*r,l=e.slice(a,f);n&&u>=i&&l.push(n),o.push(l)}return o},sort:function(e,n,r,i){return e=t.map(e,function(e){return e}),e.sort(function(e,s){var o,u;return i?(o=e[i],u=s[i]):(o=e,u=s),!r&&t.isString(o)&&t.isString(u)&&(o=o.toLowerCase(),u=u.toLowerCase()),o<u?n?1:-1:o>u?n?-1:1:0}),e},string:function(e){return n.copySafeness(e,e)},title:function(e){var t=e.split(" ");for(var i=0;i<t.length;i++)t[i]=r.capitalize(t[i]);return n.copySafeness(e,t.join(" "))},trim:function(e){return n.copySafeness(e,e.replace(/^\s*|\s*$/g,""))},truncate:function(e,t,r,i){var s=e;return t=t||255,e.length<=t?e:(r?e=e.substring(0,t):e=e.substring(0,e.lastIndexOf(" ",t)),e+=i!==undefined&&i!==null?i:"...",n.copySafeness(s,e))},upper:function(e){return e.toUpperCase()},wordcount:function(e){return e.match(/\w+/g).length},"float":function(e,t){var n=parseFloat(e);return isNaN(n)?t:n},"int":function(e,t){var n=parseInt(e,10);return isNaN(n)?t:n}};r.d=r["default"],r.e=r.escape,e.filters=r}(),function(){var t=e.lib,n=e.object,r=e.lexer,i=e.compiler,s=e.filters,o=e.loaders,u=e.runtime,a=u.Frame,f=n.extend({init:function(e,n){n=n||{},this.dev=!!n.dev,this.autoesc=!!n.autoescape,e?this.loaders=t.isArray(e)?e:[e]:o.FileSystemLoader?this.loaders=[new o.FileSystemLoader]:this.loaders=[new o.HttpLoader("/views")],n.tags&&r.setTags(n.tags),this.filters=s,this.cache={},this.extensions={},this.extensionsList=[]},addExtension:function(e,t){t._name=e,this.extensions[e]=t,this.extensionsList.push(t)},getExtension:function(e){return this.extensions[e]},addFilter:function(e,t){this.filters[e]=t},getFilter:function(e){if(!this.filters[e])throw new Error("filter not found: "+e);return this.filters[e]},getTemplate:function(e,t){e&&e.raw&&(e=e.raw);var n=null,r=this.cache[e],i;if(typeof e!="string")throw new Error("template names must be a string: "+e);if(!r||!r.isUpToDate()){for(var s=0;s<this.loaders.length;s++)if(n=this.loaders[s].getSource(e))break;if(!n)throw new Error("template not found: "+e);this.cache[e]=new c(n.src,this,n.path,n.upToDate,t)}return this.cache[e]},registerPrecompiled:function(e){for(var t in e)this.cache[t]=new c({type:"code",obj:e[t]},this,t,function(){return!0},!0)},express:function(n){var r=this;if(n.render)n.render=function(e,n,i){var s={};t.isFunction(n)&&(i=n,n={}),s=t.extend(s,this.locals),n._locals&&(s=t.extend(s,n._locals)),s=t.extend(s,n);var o=r.render(e,s);i(null,o)};else{var i=e.http,s=i.ServerResponse.prototype;s._render=function(e,n,i){var s=this.app,o={};this._locals&&(o=t.extend(o,this._locals)),n&&(o=t.extend(o,n),n.locals&&(o=t.extend(o,n.locals))),o=t.extend(o,s._locals);var u=r.render(e,o);i?i(null,u):this.send(u)}}},render:function(e,t){return this.getTemplate(e).render(t)}}),l=n.extend({init:function(e,t){this.ctx=e,this.blocks={},this.exported=[];for(var n in t)this.addBlock(n,t[n])},lookup:function(e){return this.ctx[e]},setVariable:function(e,t){this.ctx[e]=t},getVariables:function(){return this.ctx},addBlock:function(e,t){this.blocks[e]=this.blocks[e]||[],this.blocks[e].push(t)},getBlock:function(e){if(!this.blocks[e])throw new Error('unknown block "'+e+'"');return this.blocks[e][0]},getSuper:function(e,t,n,r,i){var s=(this.blocks[t]||[]).indexOf(n),o=this.blocks[t][s+1],u=this;return function(){if(s==-1||!o)throw new Error('no super block available for "'+t+'"');return o(e,u,r,i)}},addExport:function(e){this.exported.push(e)},getExported:function(){var e={};for(var t=0;t<this.exported.length;t++){var n=this.exported[t];e[n]=this.ctx[n]}return e}}),c=n.extend({init:function(e,n,r,i,s){this.env=n||new f;if(t.isObject(e))switch(e.type){case"code":this.tmplProps=e.obj;break;case"string":this.tmplStr=e.obj}else{if(!t.isString(e))throw new Error("src must be a string or an object describing the source");this.tmplStr=e}this.path=r,this.upToDate=i||function(){return!1};if(s){var o=this;t.withPrettyErrors(this.path,this.env.dev,function(){o._compile()})}else this.compiled=!1},render:function(e,n){var r=this,i=function(){r.compiled||r._compile();var t=new l(e||{},r.blocks);return r.rootRenderFunc(r.env,t,n||new a,u)};return t.withPrettyErrors(this.path,this.env.dev,i)},isUpToDate:function(){return this.upToDate()},getExported:function(){this.compiled||this._compile();var e=new l({},this.blocks);return this.rootRenderFunc(this.env,e,new a,u),e.getExported()},_compile:function(){var e;if(this.tmplProps)e=this.tmplProps;else{var t=i.compile(this.tmplStr,this.env.extensionsList,this.path),n=new Function(t);e=n()}this.blocks=this._getBlocks(e),this.rootRenderFunc=e.root,this.compiled=!0},_getBlocks:function(e){var t={};for(var n in e)n.slice(0,2)=="b_"&&(t[n.slice(2)]=e[n]);return t}});e.environment={Environment:f,Template:c}}();var t,n=e.environment,r=e.compiler,i=e.parser,s=e.lexer,o=e.loaders;t={},t.Environment=n.Environment,t.Template=n.Template,o&&(o.FileSystemLoader?t.FileSystemLoader=o.FileSystemLoader:t.HttpLoader=o.HttpLoader),t.compiler=r,t.parser=i,t.lexer=s,t.require=function(t){return e[t]},typeof define=="function"&&define.amd?define(function(){return t}):window.nunjucks=t})();